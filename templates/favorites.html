{% extends 'base.html' %}

{% block title %}Favorite Postings{% endblock %}

{% block content %}

<div class="row">
  <div class="container">
    <h1>My Favorites</h1>
    <table class="table table-striped">
        <thead>
        <tr>
            <th>Post Title</th>
            <th>Price</th>
            <th>Bedrooms</th>
            <th>Commute Time</th>
            <th></th>
        </tr>
        </thead>

        <tbody>
            {% if favorites %}
              {% for favorite in favorites %}
                  <tr id="{{favorite.favorite_id}}">
                      <td><a href={{favorite.post.url}} target="_blank">{{favorite.post.title}}</a></td>
                      <td>${{favorite.post.price}}</td>
                      <td>{{favorite.post.bedrooms}}</td>
                      <td>{{favorite.commute_time}} from  {{favorite.origin}}</td>
                      <td><button class="btn remove-button" data-id={{favorite.favorite_id}}>Remove</button></td>
                  </tr>
              {% endfor %}
            {% endif %}
        </tbody>
    </table>

  </div>
</div>

<script>
  // TODO: add event listeners to each remove button

  function removeFavorite(evt) {
    console.log($(evt.currentTarget).data("id"));
    evt.preventDefault();

    $.post('/remove-favorite',
        {'id': $(evt.currentTarget).data("id")},
        function (id) {
            $('#' + id).remove();
          })
  };

  $('.remove-button').on('click', removeFavorite);
</script>

{% endblock %}
